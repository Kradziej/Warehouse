<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3c.org/1999/xhtml"
	  xmlns:h="http://java.sun.com/jsf/html"
	  xmlns:p="http://primefaces.org/ui"
	  xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:ui="http://java.sun.com/jsf/facelets">
 
 
 <h:head>
 	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
 	
 	<script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js" type="text/javascript"></script>
 	
 	<script type="text/javascript">
 	
 	function removeItem(e) {
 		
 		$(e.target).closest('li').slideUp('slow');
 	}
 	
 	function resizeInput(e) {
 		
 		
 	}
 	
 	</script>
 	
 	
 	<style>
 	
 	nav {
		border-bottom: 2px solid #836FF2;
		opacity: 0.8;
		margin-bottom: 50px;
	}
	
	nav a:after	 {
		content: " /";
		color: black;
	}

	nav ul {
		list-style: none outside none;
		margin: 0;
		padding: 0;
		margin-left: 15px;
	}
	
	nav ul li {
		display: inline-block;
	}
	
	nav a {
		font-size: 1.1em;
		text-decoration: none;
	}
	
	body {
		font-size: 1.2em;
	}
 	
 	.logo {
 	}
 	
 	.detail {
 		border-bottom: 1px solid black;
 	}
 	
 	.mode {
 		margin-left: 5px;
 		margin-right: 8px;
 		vertical-align: middle;
 		
 	}
 	
 	.searchQuery {
 		vertical-align: middle;
 		width: 300px;
 	}
 	
 	.submitSearch {
 		vertical-align: middle;
 	}
 	
 	.submitSearch span {
 		padding: 0.16em 1em !important;
 	}
 	
 	label {
 		margin-right: 10px;
 	}
 	
 	.itemRow {
 	
 		width:100%;
 	}
 	
 	.dataRow {
 	
 		width: 100%;
 		table-layout: fixed;
 	}
 	
 	.dataRow td {
 		
 		padding-top: 60px;
 		padding-bottom: 60px;
 		text-align: center;
 		font-weight: bold;
 	}
 	
 	.dataRow td input {
 	
 	}
 	
 	.dataRow td:nth-child(3) {
 		
 		width: 50%;
 	}
 	
 	.editItem {
 	
 		padding: 0;
 		padding-right: 4px;
 		font-size: 0.8em !important;
 		position: relative;
 		bottom: 150px;
 		float: right;
 	}
 	
 	.removeItem {
 		
 		padding: 0;
 		float: right;
 		font-size: 0.8em !important;
 		position: relative;
 		bottom: 150px;
 	}
 	
 
 	.dataRowLabels td {
 		
 		padding: 0;
 	}
 	
 	.dataRowLabels {
 	
 		padding-top: 10px;
 	}
 		
 	
 
 	
 	</style>
 </h:head>



<h:body onload="#{searchView.resetView()}">


    <ui:include src="header.xhtml" />
    
	  <p:dataScroller id="searchResultScroller" value="#{searchView.items}" var="item" chunkSize="10">
	  
        <f:facet name="header">
        	<p:outputPanel id="search">
        	
        		<h:form>
					<p:inputText id="searchQuery" styleClass="searchQuery" value="#{searchView.searchQuery}" />
					<p:selectOneMenu id="mode" styleClass="mode" value="#{searchView.searchMode}">
			     		<f:selectItems value="#{searchView.searchModes}" var="mode" itemLabel="#{mode.name}" itemValue="#{mode}"/>
			     	</p:selectOneMenu>
			     	<p:commandButton id="submitSearch" styleClass="submitSearch" value="#{msg.search}" actionListener="#{searchView.search}" update="-searchResultScroller" />
		     	</h:form>
		     	
		     	<h:panelGrid styleClass="dataRow dataRowLabels" columns="5" cellpadding="0">
		     		
		     		<p:commandLink actionListener="#{searchView.sortTable}" update="-searchResultScroller" value="Nazwa"  />
		     		<p:commandLink actionListener="#{searchView.sortTable}" update="-searchResultScroller" value="Cena"  />
	                <h:outputText value="Opis" />
	                <p:commandLink actionListener="#{searchView.sortTable}" update="-searchResultScroller" value="Ilość"  />
	                <p:commandLink actionListener="#{searchView.sortTable}" update="-searchResultScroller" value="Kategoria"  />
 					
 					
                </h:panelGrid>
	     	</p:outputPanel>
        </f:facet>
 
         <h:panelGrid columns="2" id="itemRow" styleClass="itemRow" columnClasses="logo,detail" rendered="#{searchView.isSearchResult()}">
            <!--<p:graphicImage name="demo/images/car/#{car.brand}-big.gif" /> -->
 
            <p:outputPanel>
                <h:panelGrid styleClass="dataRow" columns="5" cellpadding="0">
                    
                    <h:form id="nameForm">
	                    <h:outputText value="#{item.name}" rendered="#{not searchView.editMode}" />
	                    <p:inputText id="nameInput" value="#{item.name}" rendered="#{searchView.editMode}" required="true" label="Nazwa">
	                    	<p:ajax update="@form" process="@form" listener="#{searchView.editItem}" />
	                    </p:inputText>
	                </h:form>
	                 <h:form id="priceForm">
	                    <h:outputText value="#{item.price}" rendered="#{not searchView.editMode}" />
	                    <p:inputText value="#{item.price}" rendered="#{searchView.editMode}" required="true" label="Cena" />
	                </h:form>    	
	                <h:form id="descForm">    	
	                    <h:outputText value="#{item.description}" rendered="#{not searchView.editMode}" />
	                    <p:inputText value="#{item.description}" rendered="#{searchView.editMode}" required="true" label="Opis" />
	                </h:form>   	
	                <h:form id="amountForm">   	
	                    <h:outputText value="#{item.amount}" rendered="#{not searchView.editMode}" />
	       	            <p:inputText value="#{item.amount}" rendered="#{searchView.editMode}" required="true" label="Ilość" />
	       	        </h:form>
	       	        <h:form id="catForm">     	
	                    <h:outputText value="#{item.category.name}" rendered="#{not searchView.editMode}" />
	                    <p:inputText value="#{item.category.name}" rendered="#{searchView.editMode}" required="true" label="Kategoria" />
                    </h:form>
                </h:panelGrid>
                <p:message id="messages" for="nameForm-nameInput" showDetail="true" showSummary="false" autoUpdate="true" closable="true" />
               
	            <p:commandLink id="removeItem" styleClass="removeItem" action="#{searchView.removeItem}" onsuccess="removeItem(event)" value="X" style="color: red">
	               <f:param name="removeItemId" value="#{item.id}" />
	            </p:commandLink>
	            <p:commandLink id="editItem" styleClass="editItem" action="#{searchView.edit}" update="-searchResultScroller-itemRow" onsuccess="resizeInput()" value="E" style="color: blue" />
               
                    
            </p:outputPanel>
          </h:panelGrid>
   	   </p:dataScroller>
   	   

</h:body>


</html>